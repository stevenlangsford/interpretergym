<!DOCTYPE html>
<html> 
<head>
<meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
  <!-- script load order is important. Exercise setup doesn't ref anything on this page, can go first   -->
  <!-- resource getters refer to global vars (language, difficulty settings), need to follow setup. -->
  <!-- menu scripts ref things on this page, go last-->
  <!-- this is dumb and you should go learn how to do it properly, especially the global-var settings thing -->
  <!-- the game scripts load in the head, before but the 'global vars' script in index.html <body>. So functions in game scripts that use the 'global' only work because by the time the function is *called* the var will have some value, probably because you got to the game via a 'settings' screen. This is obviously pretty unsafe/fragile. -->
  <script type="text/javascript" src="mempalace_scripts.js"></script>
  <script type="text/javascript" src="mempalace_tour_scripts.js"></script>
  <script type="text/javascript" src="nback_scripts.js"></script>
  <script src="https://unpkg.com/chinese-numbering@1.x/bundle/iife.js"></script> <!-- external dependency! -->
  <script type="text/javascript" src="infnumbers_scripts.js"></script>
  <script type="text/javascript" src="clozetrans_scripts.js"></script>
</head>
<body>

  <div id="uberdiv" class="maindiv">

    <div class="bg">
      <img src="resources/liftreading_fem.png" alt="">
    </div>
    
    <div>
      <table class='home_menu'>
      <tr>
      <td><button onClick='mempalace_home()'>Memory Palace</button></td>
      <td></td> <!-- HAHA spot the n00b go learn flexbox or something -->
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td><button onClick="mempalace_howtoplay()">How to play</button></td>
      <td><button onClick="mempalace_whytoplay()">Why to play</button></td>
    </tr>
 <tr>
      <td><button onClick='nback_home()'>N-back</button></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td><button onclick ='nback_howtoplay()'>How to play</button></td>
      <td><button onclick = 'nback_whytoplay()'>Why to play</button></td>
    </tr>

  <tr>
      <td><button onClick='cloze_home()' disabled >CLoze completions</button></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td><button disabled>How to play</button></td>
      <td><button disabled>Why to play</button></td>
    </tr>
   <tr>
      <td><button onClick='translate_home()' disabled >Just translate</button></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td><button disabled>How to play</button></td>
      <td><button disabled>Why to play</button></td>
    </tr>
   <tr>
      <td><button onClick='numbers_home()'>Infinite numbers</button></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td><button onclick='numbers_howtoplay()'>How to play</button></td>
      <td><button onclick='numbers_whytoplay()'>Why to play</button></td>
    </tr>
    <tr>
      <td><button onClick='accent_home()' disabled>Accent gym</button></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td><button onclick='accent_howtoplay()' disabled>How to play</button></td>
      <td><button onclick='accent_whytoplay()' disabled>Why to play</button></td>
    </tr>
      <!-- <tr> -->
      <!-- <td style='color:white'>Other resources: <br/><a style='color:white' href='https://apps.ankiweb.net/'>Anki</a> flashcards<br/> <a style='color:white' href='https://www.poe.com'>Poe</a> chatbot</td> -->
      <!-- <td></td> -->
      <!-- <td></td> -->
      <!-- <td></td> -->
      <!-- <td></td> -->
      <!-- <td></td> -->
      <!-- <td></td> -->
      <!-- <td></td> -->
      <!-- <td></td> -->
      <!-- <td></td> -->
      <!-- 	</tr> -->
    </table></div>
    <div class="rnddrilldiv"><button onclick="randomdrill()">Random drill</button></div>
 </div>


  <script type="text/javascript">
   //Global vars (ouch)
    let targ_lang = "blank targlang"
    let text_type = "blank text type"
    let instruction_index = 0; //bad to be global, kinda nice that it resets whenever this main pg reloads tho.

    //Keylisteners also global, with a flag changing the listener's behavior for each game.
    //Not sure which is worse, trying to have different games overwrite doc onkeypress or having this giant kludge of global vars?
    //Probably the real problem is trying to do everything on one page by overwriting uberdiv, that's the real antipattern here.
    let which_keylistener = "none"
    
    document.onkeypress = function (e) {
	if(which_keylistener=="none"){
	    return
	}

	if(which_keylistener == "cloze"){
	    console.log(e.keyCode)
	}
	
	if(which_keylistener =="numbers"){
	    if(e.keyCode==97){//'a'
		reveal()
	    }else if(e.keyCode==108){//'l'
		draw_numberChallenge()//"next"
	    }
	}
	
	if(which_keylistener =="nback"){
	    if(targ_lang == "blank targlang"){
		//means you haven't started yet
		return
	    }
	    e = e || window.event; //e.keyCode not consistent across browsers? TODO check?
	    if(nback_itemlist.length < current_n + 2){
		//still loading: press the any key to continue
		nback_drawnext()
		return 
	    }
	    if(e.keyCode==97){//'a' key
		nback_respond("same")
	    }else if(e.keyCode==108){//'l' key
		nback_respond("different")
	    }	    
	}
    };

    
   
    //Generally handy helper fns
    function toUberdiv(myhtml){
	document.getElementById("uberdiv").innerHTML = myhtml;
    }
    
    function shuffle(arr){
	return(arr.sort(()=>Math.random() - 0.5))
    }
    
    function shuffleslice(arr, n_items){
	return(arr.sort(() => Math.random() - 0.5).slice(0,n_items))
    }

    function randomdrill(){
	shuffle([mempalace_home,
		 nback_home,
		 numbers_home
		])[0]();
    }

    function random_eyecandy(){
	//unpredictable decoration is probably extra rewarding?
	css_class = shuffle(["bleft_img","bright_img"])[0]
	img_src = shuffle(
	    [
		"zh_tradlifter.png",
		"book_weights.png",
		"rubens_reader_male.png",
		"readingdude.png",
		"preston.png",
		"remington.png",
		"grumpygreek.png",
		"crazed_woodcut.png",
		"manuscript_cat.png",
		"michelangelo_bookgirl.png",
		"strideout.png",
		"confucian_treadmill.png",
		"femreader.png",
		"lift_reading.png",
		"book_demon.png",
		"illuminated_readandwrite.png",
		"rubens_reader_fem.png",
		"musclebook.png"
	    ]
	)[0]
	path = "resources/eyecandy/"
	my_html = "<img src ='"+path+img_src+"' class = '"+css_class+"'>"
	return(my_html)
    }
    //DEV ONLY: skip to current exercise here if you're gonna.
    //    nback_home()
    //    draw_numberChallenge()
    //    nback_home()
    clozetrans_home()
 </script>
 
<!-- resource files come last because they can contain getters that reference target language, text type etc, vars must exist -->
<script type="text/javascript" src="resources/concrete_wordlists.js"></script>
<script type="text/javascript" src="resources/my_palace.js"></script>
<script type="text/javascript" src="resources/monologues.js"></script>
<script type="text/javascript" src="resources/common_wordlists.js"></script>
<script type="text/javascript" src="resources/bilang_pairs.js"></script>
<!-- <script type="text/javascript" src="mainmenu_scripts.js"></script> -->


</body>
</html>
